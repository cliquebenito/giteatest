{{template "base/head" .}}
<div role="main" aria-label="{{.Title}}" class="page-content organization profile">
	<div class="container ui gt-df sc-project">
		<div class="sc-project__image">
			{{avatar $.Context .Org 144 "sc-project-avatar"}}
		</div>
		<script>
			window.config.OWProjectReposCount = {{.Org.NumRepos}};
			window.config.OWProjectName = {{.Org.LowerName}};
			// window.localStorage.setItem('OWProjectName', {{.Org.Name}});
		</script>
		<div id="org-info">
			<div class="ui sc-project-header">
				<h1 class="sc-project-title">
					{{.Org.DisplayName}}
				</h1>
				<span class="sc-project-visibility">
					{{if .Org.Visibility.IsLimited}}<span class="sc-badge sc-badge_outlined">{{.locale.Tr "org.settings.visibility.limited_shortname"}}</span>{{end}}
					{{if .Org.Visibility.IsPrivate}}<span class="sc-badge sc-badge_outlined">{{.locale.Tr "org.settings.visibility.private_shortname"}}</span>{{end}}
				</span>
				{{if .EnableFeed}}
					<a class="rss-icon" href="{{.Org.HomeLink}}.rss" data-tooltip-content="{{.locale.Tr "rss_feed"}}">{{svg "octicon-rss" 24}}</a>
				{{end}}
			</div>
			<div class="sc-project-body">
				{{if $.RenderedDescription}}<div class="sc-project-description render-content markup">{{$.RenderedDescription|Str2html}}</div>{{end}}
				<div class="sc-project-meta">
					{{if .Org.Location}}<div class="item">{{svg "octicon-location"}} <span>{{.Org.Location}}</span></div>{{end}}
					{{if .Org.Website}}<div class="item">{{svg "octicon-link"}} <a target="_blank" rel="noopener noreferrer me" href="{{.Org.Website}}">{{.Org.Website}}</a></div>{{end}}
				</div>
			</div>
		</div>
		<div class="right stackable menu">
			<form method="post" action="{{.Link}}?action={{if $.IsFollowing}}unfollow{{else}}follow{{end}}&redirect_to={{$.Link}}">
				{{$.CsrfTokenHtml}}
				<button type="submit" class="sc-button sc-button_base">
					{{if $.IsFollowing}}
						{{.locale.Tr "user.unfollow"}}
					{{else}}
						{{.locale.Tr "user.follow"}}
					{{end}}
				</button>
			</form>
		</div>
	</div>

	{{template "org/menu" .}}

	<div class="container ui">
		<div class="grid ui mobile reversed stackable">
			<div class="ui eleven wide column">
				{{template "explore/repo_search" .}}
				{{template "explore/repo_list" .}}
				{{template "base/paginate" .}}
			</div>

			<div class="ui five wide column">
				{{if CheckPrivileges .TraceID .TraceEndpoint .SignedUser.ID .TenantID .Org.ID "create"}}
					<div class="center aligned org-new-buttons-group">
						<a class="sc-button sc-button_primary" href="{{AppSubUrl}}/repo/create?org={{.Org.ID}}">{{.locale.Tr "new_repo"}}</a>
					</div>
					<div class="ui divider"></div>
				{{end}}

				{{if not EnableRoleModel }}
					<div class="center aligned org-new-buttons-group">
						<a class="sc-button sc-button_primary" href="{{AppSubUrl}}/repo/create?org={{.Org.ID}}">{{.locale.Tr "new_repo"}}</a>
					</div>
					<div class="ui divider"></div>
					<h4 class="ui top attached header gt-df">
						<strong class="gt-f1">{{.locale.Tr "org.members"}}</strong>
						<a class="text grey gt-dif gt-ac" href="{{.OrgLink}}/members"><span>{{.MembersTotal}}</span> {{svg "octicon-chevron-right"}}</a>
					</h4>
					<div class="ui attached segment members">
						{{$isMember := .IsOrganizationMember}}
						{{range .Members}}
							{{if or $isMember (call $.IsPublicMember .ID)}}
								<a href="{{.HomeLink}}" title="{{.Name}}{{if .FullName}} ({{.FullName}}){{end}}">
									{{avatar $.Context . 48}}
								</a>
							{{end}}
						{{end}}
					</div>
				{{end}}
				{{ if not EnableRoleModel }}
					<div class="sc-project-section">
						<h4 class="sc-project-section__title">
							<a href="{{.OrgLink}}/members">{{.locale.Tr "org.members"}}</a>
								<span class="sc-project-badge">{{.MembersTotal}}</span>
						</h4>
							<ul class="sc-project-member-list">
								{{$isMember := .IsOrganizationMember}}
									{{range .Members}}
										{{if or $isMember (call $.IsPublicMember .ID)}}
											<li>
												<a href="{{.HomeLink}}" title="{{.Name}}{{if .FullName}} ({{.FullName}}){{end}}">{{avatar $.Context . 48}}</a>
											</li>
									{{end}}
								{{end}}
							</ul>
					</div>
				{{end}}
				{{if CheckPrivileges .TraceID .TraceEndpoint .SignedUser.ID .TenantID .Org.ID "own"}}
					{{if and .IsOrganizationMember (len .Teams)}}
						<div class="sc-box sc-box_attached">
							<div class="sc-box__header">
								<strong class="gt-f1">{{.locale.Tr "org.teams"}}</strong>
								<a class="text grey gt-dif gt-ac" href="{{.OrgLink}}/teams"><span>{{.Org.NumTeams}}</span> {{svg "octicon-chevron-right"}}</a>
							</div>
							<div class="sc-box__body">
								{{range .Teams}}
									<div class="item">
										<a href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}"><strong class="team-name">{{.Name}}</strong></a>
										<p class="text grey">
											<a class="muted" href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}"><strong>{{.NumMembers}}</strong> {{$.locale.Tr "org.lower_members"}}</a> Â·
											<a class="muted" href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}/repositories"><strong>{{.NumRepos}}</strong> {{$.locale.Tr "org.lower_repositories"}}</a>
										</p>
									</div>
								{{end}}
							</div>
							{{if and .IsOrganizationOwner (not EnableOneWork)}}
								<div class="sc-box__body">
									<a class="sc-button sc-button_primary" href="{{.OrgLink}}/teams/new">{{.locale.Tr "org.create_new_team"}}</a>
								</div>
							{{end}}
						</div>
					{{end}}
				{{end}}
			</div>
		</div>
	</div>
</div>
{{template "base/footer" .}}
