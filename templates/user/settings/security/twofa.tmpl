<div class="sc-box sc-box_attached gt-mb-4">
	<h4 class="sc-box__header">
		{{.locale.Tr "settings.twofa"}}
	</h4>
	<div class="sc-box__body">
		<p>{{.locale.Tr "settings.twofa_desc"}}</p>
		{{if .TOTPEnrolled}}
		<p>{{$.locale.Tr "settings.twofa_is_enrolled" | Str2html}}</p>
		<form class="ui form" action="{{AppSubUrl}}/user/settings/security/two_factor/regenerate_scratch" method="post" enctype="multipart/form-data">
			{{.CsrfTokenHtml}}
			<p>{{.locale.Tr "settings.regenerate_scratch_token_desc"}}</p>
			<button class="sc-button sc-button_primary">{{$.locale.Tr "settings.twofa_scratch_token_regenerate"}}</button>
		</form>
		<form class="ui form" action="{{AppSubUrl}}/user/settings/security/two_factor/disable" method="post" enctype="multipart/form-data" id="disable-form">
			{{.CsrfTokenHtml}}
			<p>{{.locale.Tr "settings.twofa_disable_note"}}</p>
			<button class="sc-button sc-button_danger" data-modal-id="disable-twofa" data-type="form" data-form="#disable-form">{{$.locale.Tr "settings.twofa_disable"}}</button>
		</form>
		{{else}}
		<p>{{.locale.Tr "settings.twofa_not_enrolled"}}</p>
		<div class="inline field">
			<a class="sc-button sc-button_primary" href="{{AppSubUrl}}/user/settings/security/two_factor/enroll">{{$.locale.Tr "settings.twofa_enroll"}}</a>
		</div>
		{{end}}
	</div>
</div>

<div class="ui g-modal-confirm delete modal" id="disable-twofa">
	<div class="header">
		{{svg "octicon-trash"}}
		{{.locale.Tr "settings.twofa_disable"}}
	</div>
	<div class="content">
		<p>{{.locale.Tr "settings.twofa_disable_desc"}}</p>
	</div>
	{{template "base/modal_actions_confirm" .}}
</div>
