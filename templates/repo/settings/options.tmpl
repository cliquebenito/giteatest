{{template "repo/settings/layout_head" (dict "ctxData" . "pageClass" "repository settings options")}}
	<div class="user-main-content twelve wide column">
		<h4 class="ui top attached header">
			{{.locale.Tr "repo.settings.basic_settings"}}
		</h4>
		<div class="ui attached segment">
			<form class="ui form" action="{{.Link}}" method="post">
				{{template "base/disable_form_autofill"}}
				{{.CsrfTokenHtml}}
				<input type="hidden" name="action" value="update">
				<div class="required field {{if .Err_RepoName}}error{{end}} disabled">
					<label for="repo_name">{{.locale.Tr "repo.repo_name"}}</label>
					<input id="repo_name" name="repo_name" value="{{.Repository.Name}}" data-repo-name="{{.Repository.Name}}" required>
				</div>
				<div class="inline field">
					<label>{{.locale.Tr "repo.repo_size"}}</label>
					<span>{{FileSize .Repository.Size}}</span>
				</div>
				<div class="inline field {{if EnableOneWork}}disabled{{end}}">
					<label>{{.locale.Tr "repo.template"}}</label>
					<div class="ui checkbox">
						<input name="template" type="checkbox" {{if .Repository.IsTemplate}}checked{{end}}>
						<label>{{.locale.Tr "repo.template_helper"}}</label>
					</div>
				</div>
				{{if not .Repository.IsFork}}
					<div class="inline field {{if EnableOneWork}}disabled{{end}}">
						<label>{{.locale.Tr "repo.visibility"}}</label>
						<div class="ui checkbox">
							{{if .IsAdmin}}
							<input name="private" type="checkbox" {{if .Repository.IsPrivate}}checked{{end}}>
							{{else}}
							<input name="private" type="checkbox" {{if .Repository.IsPrivate}}checked{{end}}{{if and $.ForcePrivate .Repository.IsPrivate}} readonly{{end}}>
							{{end}}
							<label>{{.locale.Tr "repo.visibility_helper" | Safe}} {{if .Repository.NumForks}}<span class="text red">{{.locale.Tr "repo.visibility_fork_helper"}}</span>{{end}}</label>
						</div>
					</div>
				{{end}}
				<div class="field {{if .Err_Description}}error{{end}} {{if EnableOneWork}}disabled{{end}}">
					<label for="description">{{$.locale.Tr "repo.repo_desc"}}</label>
					<textarea id="description" name="description" rows="2" maxlength="2048">{{.Repository.Description}}</textarea>
				</div>
				<div class="field {{if .Err_Website}}error{{end}} {{if EnableOneWork}}disabled{{end}}">
					<label for="website">{{.locale.Tr "repo.settings.site"}}</label>
					<input id="website" name="website" type="url" maxlength="1024" value="{{.Repository.Website}}">
				</div>
				{{if not EnableOneWork}}
					<div class="field">
						<button class="sc-button sc-button_primary">{{$.locale.Tr "repo.settings.update_settings"}}</button>
					</div>
				{{end}}
			</form>

			<div class="ui divider"></div>

			<form class="ui form" action="{{.Link}}/avatar" method="post" enctype="multipart/form-data">
				{{.CsrfTokenHtml}}
				<div class="inline field">
					<label for="avatar">{{.locale.Tr "settings.choose_new_avatar"}}</label>
					<input name="avatar" type="file" accept="image/png,image/jpeg,image/gif,image/webp">
				</div>

				<div class="field">
					<button class="sc-button sc-button_primary">{{$.locale.Tr "settings.update_avatar"}}</button>
					<a class="button delete-post sc-button sc-button_danger " data-request-url="{{.Link}}/avatar/delete" data-done-url="{{.Link}}">{{$.locale.Tr "settings.delete_current_avatar"}}</a>
				</div>
			</form>

		</div>

		<h4 class="ui top attached header">
			{{.locale.Tr "repo.settings.advanced_settings"}}
		</h4>
		<div class="ui attached segment">
			<form class="ui form" method="post">
				{{.CsrfTokenHtml}}
				<input type="hidden" name="action" value="advanced">

				{{$isCodeEnabled := .Repository.UnitEnabled $.Context $.UnitTypeCode}}
				<div class="inline field">
					<label>{{.locale.Tr "repo.code"}}</label>
					{{if .UnitTypeCode.UnitGlobalDisabled}}
					<div class="ui checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
					{{else}}
					<div class="ui checkbox">
					{{end}}
						<input class="enable-system" name="enable_code" type="checkbox"{{if $isCodeEnabled}} checked{{end}}>
						<label>{{.locale.Tr "repo.code.desc"}}</label>
					</div>
				</div>

				{{$isWikiEnabled := or (.Repository.UnitEnabled $.Context $.UnitTypeWiki) (.Repository.UnitEnabled $.Context $.UnitTypeExternalWiki)}}
				<div class="inline field">
					<label>{{.locale.Tr "repo.wiki"}}</label>
					{{if and (.UnitTypeWiki.UnitGlobalDisabled) (.UnitTypeExternalWiki.UnitGlobalDisabled)}}
					<div class="ui checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
					{{else}}
					<div class="ui checkbox">
					{{end}}
						<input class="enable-system" name="enable_wiki" type="checkbox" data-target="#wiki_box" {{if $isWikiEnabled}}checked{{end}}>
						<label>{{.locale.Tr "repo.settings.wiki_desc"}}</label>
					</div>
				</div>
				<div class="field {{if not $isWikiEnabled}}disabled{{end}}" id="wiki_box">
					<div class="field">
						{{if .UnitTypeWiki.UnitGlobalDisabled}}
						<div class="ui radio checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
						{{else}}
						<div class="ui radio checkbox">
						{{end}}
							<input class="enable-system-radio" tabindex="0" name="enable_external_wiki" type="radio" value="false" data-target="#external_wiki_box" {{if not (.Repository.UnitEnabled $.Context $.UnitTypeExternalWiki)}}checked{{end}}>
							<label>{{.locale.Tr "repo.settings.use_internal_wiki"}}</label>
						</div>
					</div>
					<div class="field">
						{{if .UnitTypeExternalWiki.UnitGlobalDisabled}}
						<div class="ui radio checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
						{{else}}
						<div class="ui radio checkbox">
						{{end}}
							<input class="enable-system-radio" tabindex="0" name="enable_external_wiki" type="radio" value="true" data-target="#external_wiki_box" {{if .Repository.UnitEnabled $.Context $.UnitTypeExternalWiki}}checked{{end}}>
							<label>{{.locale.Tr "repo.settings.use_external_wiki"}}</label>
						</div>
					</div>
					<div class="field {{if not (.Repository.UnitEnabled $.Context $.UnitTypeExternalWiki)}}disabled{{end}}" id="external_wiki_box">
						<label for="external_wiki_url">{{.locale.Tr "repo.settings.external_wiki_url"}}</label>
						<input id="external_wiki_url" name="external_wiki_url" type="url" value="{{(.Repository.MustGetUnit $.Context $.UnitTypeExternalWiki).ExternalWikiConfig.ExternalWikiURL}}">
						<p class="help">{{.locale.Tr "repo.settings.external_wiki_url_desc"}}</p>
					</div>
				</div>

				<div class="ui divider"></div>

				{{$isIssuesEnabled := or (.Repository.UnitEnabled $.Context $.UnitTypeIssues) (.Repository.UnitEnabled $.Context $.UnitTypeExternalTracker)}}
				<div class="inline field">
					<label>{{.locale.Tr "repo.issues"}}</label>
					{{if and (.UnitTypeIssues.UnitGlobalDisabled) (.UnitTypeExternalTracker.UnitGlobalDisabled)}}
					<div class="ui checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
					{{else}}
					<div class="ui checkbox">
					{{end}}
						<input class="enable-system" name="enable_issues" type="checkbox" data-target="#issue_box" {{if $isIssuesEnabled}}checked{{end}}>
						<label>{{.locale.Tr "repo.settings.issues_desc"}}</label>
					</div>
				</div>
				<div class="field {{if not $isIssuesEnabled}}disabled{{end}}" id="issue_box">
					<div class="field">
						{{if .UnitTypeIssues.UnitGlobalDisabled}}
						<div class="ui radio checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
						{{else}}
						<div class="ui radio checkbox">
						{{end}}
							<input class="enable-system-radio" tabindex="0" name="enable_external_tracker" type="radio" value="false" data-context="#internal_issue_box" data-target="#external_issue_box" {{if not (.Repository.UnitEnabled $.Context $.UnitTypeExternalTracker)}}checked{{end}}>
							<label>{{.locale.Tr "repo.settings.use_internal_issue_tracker"}}</label>
						</div>
					</div>
					<div class="field {{if (.Repository.UnitEnabled $.Context $.UnitTypeExternalTracker)}}disabled{{end}}" id="internal_issue_box">
						{{if .Repository.CanEnableTimetracker}}
							<div class="field">
								<div class="ui checkbox">
									<input name="enable_timetracker" class="enable-system" data-target="#only_contributors" type="checkbox" {{if .Repository.IsTimetrackerEnabled $.Context}}checked{{end}}>
									<label>{{.locale.Tr "repo.settings.enable_timetracker"}}</label>
								</div>
							</div>
							<div class="field {{if not (.Repository.IsTimetrackerEnabled $.Context)}}disabled{{end}}" id="only_contributors">
								<div class="ui checkbox">
									<input name="allow_only_contributors_to_track_time" type="checkbox" {{if .Repository.AllowOnlyContributorsToTrackTime $.Context}}checked{{end}}>
									<label>{{.locale.Tr "repo.settings.allow_only_contributors_to_track_time"}}</label>
								</div>
							</div>
						{{end}}
						<div class="field">
							<div class="ui checkbox">
								<input name="enable_issue_dependencies" type="checkbox" {{if (.Repository.IsDependenciesEnabled $.Context)}}checked{{end}}>
								<label>{{.locale.Tr "repo.issues.dependency.setting"}}</label>
							</div>
						</div>
						<div class="ui checkbox">
							<input name="enable_close_issues_via_commit_in_any_branch" type="checkbox" {{if .Repository.CloseIssuesViaCommitInAnyBranch}}checked{{end}}>
							<label>{{.locale.Tr "repo.settings.admin_enable_close_issues_via_commit_in_any_branch"}}</label>
						</div>
					</div>
					<div class="field">
						{{if .UnitTypeExternalTracker.UnitGlobalDisabled}}
						<div class="ui radio checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
						{{else}}
						<div class="ui radio checkbox">
						{{end}}
							<input class="enable-system-radio" tabindex="0" name="enable_external_tracker" type="radio" value="true" data-context="#internal_issue_box" data-target="#external_issue_box" {{if .Repository.UnitEnabled $.Context $.UnitTypeExternalTracker}}checked{{end}}>
							<label>{{.locale.Tr "repo.settings.use_external_issue_tracker"}}</label>
						</div>
					</div>
					<div class="field {{if not (.Repository.UnitEnabled $.Context $.UnitTypeExternalTracker)}}disabled{{end}}" id="external_issue_box">
						<div class="field">
							<label for="external_tracker_url">{{.locale.Tr "repo.settings.external_tracker_url"}}</label>
							<input id="external_tracker_url" name="external_tracker_url" type="url" value="{{(.Repository.MustGetUnit $.Context $.UnitTypeExternalTracker).ExternalTrackerConfig.ExternalTrackerURL}}">
							<p class="help">{{.locale.Tr "repo.settings.external_tracker_url_desc"}}</p>
						</div>
						<div class="field">
							<label for="tracker_url_format">{{.locale.Tr "repo.settings.tracker_url_format"}}</label>
							<input id="tracker_url_format" name="tracker_url_format" type="url" value="{{(.Repository.MustGetUnit $.Context $.UnitTypeExternalTracker).ExternalTrackerConfig.ExternalTrackerFormat}}" placeholder="e.g. https://github.com/{user}/{repo}/issues/{index}">
							<p class="help">{{.locale.Tr "repo.settings.tracker_url_format_desc" | Str2html}}</p>
						</div>
						<div class="field ">
							<label for="issue_style">{{.locale.Tr "repo.settings.tracker_issue_style"}}</label>
							<div class="field">
								<div class="ui radio checkbox">
								{{$externalTracker := (.Repository.MustGetUnit $.Context $.UnitTypeExternalTracker)}}
								{{$externalTrackerStyle := $externalTracker.ExternalTrackerConfig.ExternalTrackerStyle}}
									<input class="js-tracker-issue-style" name="tracker_issue_style" type="radio" value="numeric" {{if eq $externalTrackerStyle "numeric"}}checked{{end}}>
									<label>{{.locale.Tr "repo.settings.tracker_issue_style.numeric"}} <span class="ui light grey text">#1234</span></label>
								</div>
							</div>
							<div class="field">
								<div class="ui radio checkbox">
									<input class="js-tracker-issue-style" name="tracker_issue_style" type="radio" value="alphanumeric" {{if eq $externalTrackerStyle "alphanumeric"}}checked{{end}}>
									<label>{{.locale.Tr "repo.settings.tracker_issue_style.alphanumeric"}} <span class="ui light grey text">ABC-123 , DEFG-234</span></label>
								</div>
							</div>
							<div class="field">
								<div class="ui radio checkbox">
									<input class="js-tracker-issue-style" name="tracker_issue_style" type="radio" value="regexp" {{if eq $externalTrackerStyle "regexp"}}checked{{end}}>
									<label>{{.locale.Tr "repo.settings.tracker_issue_style.regexp"}} <span class="ui light grey text">(ISSUE-\d+) , ISSUE-(\d+)</span></label>
								</div>
							</div>
						</div>
						<div class="field {{if ne $externalTrackerStyle "regexp"}}disabled{{end}}" id="tracker-issue-style-regex-box">
							<label for="external_tracker_regexp_pattern">{{.locale.Tr "repo.settings.tracker_issue_style.regexp_pattern"}}</label>
							<input id="external_tracker_regexp_pattern" name="external_tracker_regexp_pattern" value="{{(.Repository.MustGetUnit $.Context $.UnitTypeExternalTracker).ExternalTrackerConfig.ExternalTrackerRegexpPattern}}">
							<p class="help">{{.locale.Tr "repo.settings.tracker_issue_style.regexp_pattern_desc" | Str2html}}</p>
						</div>
					</div>
				</div>

				<div class="ui divider"></div>

				{{$isProjectsEnabled := .Repository.UnitEnabled $.Context $.UnitTypeProjects}}
				<div class="inline field">
					<label>{{.locale.Tr "repo.project_board"}}</label>
					{{if .UnitTypeProjects.UnitGlobalDisabled}}
					<div class="ui checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
					{{else}}
					<div class="ui checkbox">
					{{end}}
						<input class="enable-system" name="enable_projects" type="checkbox" {{if $isProjectsEnabled}}checked{{end}}>
						<label>{{.locale.Tr "repo.settings.projects_desc"}}</label>
					</div>
				</div>

				{{$isReleasesEnabled := .Repository.UnitEnabled $.Context $.UnitTypeReleases}}
				<div class="inline field">
					<label>{{.locale.Tr "repo.releases"}}</label>
					{{if .UnitTypeReleases.UnitGlobalDisabled}}
					<div class="ui checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
					{{else}}
					<div class="ui checkbox">
					{{end}}
						<input class="enable-system" name="enable_releases" type="checkbox" {{if $isReleasesEnabled}}checked{{end}}>
						<label>{{.locale.Tr "repo.settings.releases_desc"}}</label>
					</div>
				</div>

				{{$isPackagesEnabled := .Repository.UnitEnabled $.Context $.UnitTypePackages}}
				<div class="inline field">
					<label>{{.locale.Tr "repo.packages"}}</label>
					{{if .UnitTypePackages.UnitGlobalDisabled}}
					<div class="ui checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
					{{else}}
					<div class="ui checkbox">
					{{end}}
						<input class="enable-system" name="enable_packages" type="checkbox" {{if $isPackagesEnabled}}checked{{end}}>
						<label>{{.locale.Tr "repo.settings.packages_desc"}}</label>
					</div>
				</div>

				{{if .EnableActions}}
					{{$isActionsEnabled := .Repository.UnitEnabled $.Context $.UnitTypeActions}}
					<div class="inline field">
						<label>{{.locale.Tr "actions.actions"}}</label>
						{{if .UnitTypeActions.UnitGlobalDisabled}}
							<div class="ui checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
						{{else}}
							<div class="ui checkbox">
						{{end}}
							<input class="enable-system" name="enable_actions" type="checkbox" {{if $isActionsEnabled}}checked{{end}}>
							<label>{{.locale.Tr "repo.settings.actions_desc"}}</label>
						</div>
					</div>
				{{end}}

				{{if not .IsMirror}}
					<div class="ui divider"></div>
					{{$pullRequestEnabled := .Repository.UnitEnabled $.Context $.UnitTypePullRequests}}
					{{$prUnit := .Repository.MustGetUnit $.Context $.UnitTypePullRequests}}
					<div class="inline field">
						<label>{{.locale.Tr "repo.pulls"}}</label>
						{{if .UnitTypePullRequests.UnitGlobalDisabled}}
						<div class="ui checkbox disabled" data-tooltip-content="{{.locale.Tr "repo.unit_disabled"}}">
						{{else}}
						<div class="ui checkbox">
						{{end}}
							<input class="enable-system" name="enable_pulls" type="checkbox" data-target="#pull_box" {{if $pullRequestEnabled}}checked{{end}}>
							<label>{{.locale.Tr "repo.settings.pulls_desc"}}</label>
						</div>
					</div>
					<div class="field{{if not $pullRequestEnabled}} disabled{{end}}" id="pull_box_admin_can_merge_without_checks">
					  <div class="field">
						{{if EnableRoleModel }}
						{{if CheckPrivileges .TraceID .TraceEndpoint .SignedUser.ID .TenantID .Owner.ID "merge_without_check" }}
							<div class="ui checkbox">
								<input name="pulls_admin_can_merge_without_checks" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.AdminCanMergeWithoutChecks)}}checked{{end}}>
								<label>{{.locale.Tr "repo.pulls.admin_can_merge_without_checks"}}</label>
							</div>
						{{end}}
						{{else}}
								<div class="ui checkbox">
									<input name="pulls_admin_can_merge_without_checks" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.AdminCanMergeWithoutChecks)}}checked{{end}}>
									<label>{{.locale.Tr "repo.pulls.admin_can_merge_without_checks"}}</label>
								</div>
							{{end}}
					  	</div>
					</div>
					<div class="field{{if not $pullRequestEnabled}} disabled{{end}}" id="pull_box">
						<div class="field">
							<p>
								{{.locale.Tr "repo.settings.merge_style_desc"}}
							</p>
						</div>
						<div class="field">
							<div class="ui checkbox">
								<input name="pulls_allow_merge" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.AllowMerge)}}checked{{end}}>
								<label>{{.locale.Tr "repo.pulls.merge_pull_request"}}</label>
							</div>
						</div>
						<div class="field">
							<div class="ui checkbox">
								<input name="pulls_allow_rebase" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.AllowRebase)}}checked{{end}}>
								<label>{{.locale.Tr "repo.pulls.rebase_merge_pull_request"}}</label>
							</div>
						</div>
						<div class="field">
							<div class="ui checkbox">
								<input name="pulls_allow_rebase_merge" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.AllowRebaseMerge)}}checked{{end}}>
								<label>{{.locale.Tr "repo.pulls.rebase_merge_commit_pull_request"}}</label>
							</div>
						</div>
						<div class="field">
							<div class="ui checkbox">
								<input name="pulls_allow_squash" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.AllowSquash)}}checked{{end}}>
								<label>{{.locale.Tr "repo.pulls.squash_merge_pull_request"}}</label>
							</div>
						</div>
						<div class="field">
							<div class="ui checkbox">
								<input name="pulls_allow_manual_merge" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.AllowManualMerge)}}checked{{end}}>
								<label>{{.locale.Tr "repo.pulls.merge_manually"}}</label>
							</div>
						</div>

						<div class="field">
							<p>
								{{.locale.Tr "repo.settings.default_merge_style_desc"}}
							</p>
							<div class="ui dropdown selection" tabindex="0">
								<select name="pulls_default_merge_style">
									<option value="merge" {{if or (not $pullRequestEnabled) (eq $prUnit.PullRequestsConfig.DefaultMergeStyle "merge")}}selected{{end}}>{{.locale.Tr "repo.pulls.merge_pull_request"}}</option>
									<option value="rebase" {{if or (not $pullRequestEnabled) (eq $prUnit.PullRequestsConfig.DefaultMergeStyle "rebase")}}selected{{end}}>{{.locale.Tr "repo.pulls.rebase_merge_pull_request"}}</option>
									<option value="rebase-merge" {{if or (not $pullRequestEnabled) (eq $prUnit.PullRequestsConfig.DefaultMergeStyle "rebase-merge")}}selected{{end}}>{{.locale.Tr "repo.pulls.rebase_merge_commit_pull_request"}}</option>
									<option value="squash" {{if or (not $pullRequestEnabled) (eq $prUnit.PullRequestsConfig.DefaultMergeStyle "squash")}}selected{{end}}>{{.locale.Tr "repo.pulls.squash_merge_pull_request"}}</option>
								</select>{{svg "octicon-triangle-down" 14 "dropdown icon"}}
								<div class="default text">
									{{if (eq $prUnit.PullRequestsConfig.DefaultMergeStyle "merge")}}
										{{.locale.Tr "repo.pulls.merge_pull_request"}}
									{{end}}
									{{if (eq $prUnit.PullRequestsConfig.DefaultMergeStyle "rebase")}}
										{{.locale.Tr "repo.pulls.rebase_merge_pull_request"}}
									{{end}}
									{{if (eq $prUnit.PullRequestsConfig.DefaultMergeStyle "rebase-merge")}}
										{{.locale.Tr "repo.pulls.rebase_merge_commit_pull_request"}}
									{{end}}
									{{if (eq $prUnit.PullRequestsConfig.DefaultMergeStyle "squash")}}
										{{.locale.Tr "repo.pulls.squash_merge_pull_request"}}
									{{end}}
								</div>
								<div class="menu">
									<div class="item" data-value="merge">{{.locale.Tr "repo.pulls.merge_pull_request"}}</div>
									<div class="item" data-value="rebase">{{.locale.Tr "repo.pulls.rebase_merge_pull_request"}}</div>
									<div class="item" data-value="rebase-merge">{{.locale.Tr "repo.pulls.rebase_merge_commit_pull_request"}}</div>
									<div class="item" data-value="squash">{{.locale.Tr "repo.pulls.squash_merge_pull_request"}}</div>
								</div>
							</div>
						</div>
						<div class="field">
							<div class="ui checkbox">
								<input name="default_allow_maintainer_edit" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.DefaultAllowMaintainerEdit)}}checked{{end}}>
								<label>{{.locale.Tr "repo.settings.pulls.default_allow_edits_from_maintainers"}}</label>
							</div>
						</div>
						<div class="field">
							<div class="ui checkbox">
								<input name="pulls_allow_rebase_update" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.AllowRebaseUpdate)}}checked{{end}}>
								<label>{{.locale.Tr "repo.settings.pulls.allow_rebase_update"}}</label>
							</div>
						</div>
						<div class="field">
							<div class="ui checkbox">
								<input name="default_delete_branch_after_merge" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.DefaultDeleteBranchAfterMerge)}}checked{{end}}>
								<label>{{.locale.Tr "repo.settings.pulls.default_delete_branch_after_merge"}}</label>
							</div>
						</div>
						<div class="field">
							<div class="ui checkbox">
								<input name="enable_autodetect_manual_merge" type="checkbox" {{if or (not $pullRequestEnabled) ($prUnit.PullRequestsConfig.AutodetectManualMerge)}}checked{{end}}>
								<label>{{.locale.Tr "repo.settings.pulls.enable_autodetect_manual_merge"}}</label>
							</div>
						</div>
						<div class="field">
							<div class="ui checkbox">
								<input name="pulls_ignore_whitespace" type="checkbox" {{if and $pullRequestEnabled ($prUnit.PullRequestsConfig.IgnoreWhitespaceConflicts)}}checked{{end}}>
								<label>{{.locale.Tr "repo.settings.pulls.ignore_whitespace"}}</label>
							</div>
						</div>
					</div>
				{{end}}

				<div class="ui divider"></div>
				<div class="field">
					<button class="sc-button sc-button_primary">{{$.locale.Tr "repo.settings.update_settings"}}</button>
				</div>
			</form>
		</div>

		<h4 class="ui top attached header">
			{{.locale.Tr "repo.settings.signing_settings"}}
		</h4>
		<div class="ui attached segment">
			<form class="ui form" method="post">
				{{.CsrfTokenHtml}}
				<input type="hidden" name="action" value="signing">
				<div class="field">
					<label>{{.locale.Tr "repo.settings.trust_model"}}</label><br>
					<div class="field">
						<div class="ui radio checkbox">
							<input type="radio" id="trust_model_default" name="trust_model" {{if eq .Repository.TrustModel.String "default"}}checked="checked"{{end}} value="default">
							<label for="trust_model_default">{{.locale.Tr "repo.settings.trust_model.default"}}</label>
							<p class="help">{{.locale.Tr "repo.settings.trust_model.default.desc"}}</p>
						</div>
					</div>
					<div class="field">
						<div class="ui radio checkbox">
							<input type="radio" id="trust_model_collaborator" name="trust_model" {{if eq .Repository.TrustModel.String "collaborator"}}checked="checked"{{end}} value="collaborator">
							<label for="trust_model_collaborator">{{.locale.Tr "repo.settings.trust_model.collaborator.long"}}</label>
							<p class="help">{{.locale.Tr "repo.settings.trust_model.collaborator.desc"}}</p>
						</div>
					</div>
					<div class="field">
						<div class="ui radio checkbox">
							<input type="radio" name="trust_model" id="trust_model_committer" {{if eq .Repository.TrustModel.String "committer"}}checked="checked"{{end}} value="committer">
							<label for="trust_model_committer">{{.locale.Tr "repo.settings.trust_model.committer.long"}}</label>
							<p class="help">{{.locale.Tr "repo.settings.trust_model.committer.desc"}}</p>
						</div>
					</div>
					<div class="field">
						<div class="ui radio checkbox">
							<input type="radio" name="trust_model" id="trust_model_collaboratorcommitter" {{if eq .Repository.TrustModel.String "collaboratorcommitter"}}checked="checked"{{end}} value="collaboratorcommitter">
							<label for="trust_model_collaboratorcommitter">{{.locale.Tr "repo.settings.trust_model.collaboratorcommitter.long"}}</label>
							<p class="help">{{.locale.Tr "repo.settings.trust_model.collaboratorcommitter.desc"}}</p>
						</div>
					</div>
				</div>

				<div class="ui divider"></div>
				<div class="field">
					<button class="sc-button sc-button_primary">{{$.locale.Tr "repo.settings.update_settings"}}</button>
				</div>
			</form>
		</div>

	{{if .IsAdmin}}
		<h4 class="ui top attached header">
			{{.locale.Tr "repo.settings.admin_settings"}}
		</h4>
		<div class="ui attached segment">
			<form class="ui form" method="post">
				{{.CsrfTokenHtml}}
				<input type="hidden" name="action" value="admin">
				<div class="field">
					<div class="ui checkbox">
						<input name="enable_health_check" type="checkbox" {{if .Repository.IsFsckEnabled}}checked{{end}}>
						<label>{{.locale.Tr "repo.settings.admin_enable_health_check"}}</label>
					</div>
				</div>

				<div class="field">
					<button class="sc-button sc-button_primary">{{$.locale.Tr "repo.settings.update_settings"}}</button>
				</div>
			</form>

			<div class="ui divider"></div>
			<form class="ui form" method="post">
				{{.CsrfTokenHtml}}
				<input type="hidden" name="action" value="admin_index">
				{{if .CodeIndexerEnabled}}
					<h4 class="ui header">{{.locale.Tr "repo.settings.admin_code_indexer"}}</h4>
					<div class="inline fields">
						<label>{{.locale.Tr "repo.settings.admin_indexer_commit_sha"}}</label>
						<span class="field">
							{{if .CodeIndexerStatus}}
								<a rel="nofollow" class="ui sha label" href="{{.RepoLink}}/commit/{{.CodeIndexerStatus.CommitSha}}">
									<span class="shortsha">{{ShortSha .CodeIndexerStatus.CommitSha}}</span>
								</a>
							{{else}}
									<span>{{.locale.Tr "repo.settings.admin_indexer_unindexed"}}</span>
							{{end}}
						</span>
						<div class="field">
							<button class="sc-button sc-button_primary" name="request_reindex_type" value="code">{{$.locale.Tr "repo.settings.reindex_button"}}</button>
						</div>
					</div>
				{{end}}
				<h4 class="ui header">{{.locale.Tr "repo.settings.admin_stats_indexer"}}</h4>
				<div class="inline fields">
					<label>{{.locale.Tr "repo.settings.admin_indexer_commit_sha"}}</label>
					<span class="field">
						{{if .StatsIndexerStatus}}
							<a rel="nofollow" class="ui sha label" href="{{.RepoLink}}/commit/{{.StatsIndexerStatus.CommitSha}}">
								<span class="shortsha">{{ShortSha .StatsIndexerStatus.CommitSha}}</span>
							</a>
						{{else}}
							<span>{{.locale.Tr "repo.settings.admin_indexer_unindexed"}}</span>
						{{end}}
					</span>
					<div class="field">
						<button class="sc-button sc-button_primary" name="request_reindex_type" value="stats">{{$.locale.Tr "repo.settings.reindex_button"}}</button>
					</div>
				</div>
			</form>
		</div>
	{{end}}


	{{if .Permission.IsOwner}}
	<h4 class="ui top attached header">
		{{.locale.Tr "repo.settings.owners_settings"}}
	</h4>
	<div class="ui attached segment owners">
		<form class="ui form" method="post" action="settings">
			{{.CsrfTokenHtml}}
			<input type="hidden" name="action" value="owners">
			<div class="field">
				<div class="ui checkbox">
					<input name="approval_status" type="checkbox" id="approvalCheckbox" {{if .CodeOwnersSettings.ApprovalStatus}}checked{{end}}>
					<label>{{.locale.Tr "repo.settings.owners_approval_status"}}</label>
				</div>

				<input type="hidden">
				<div class="owners">
					<label for="amount_users">{{.locale.Tr "repo.owner_approve_amount"}}</label>
					<input class="owners-input"
								 id="amountUsersInput"
								 name="amount_users"
								 value="{{ if eq .CodeOwnersSettings.AmountUsers 0 }}{{ else }}{{ .CodeOwnersSettings.AmountUsers }}{{ end }}"
								 oninput="validateInput(this)"
								 required>
					<span class="error-message"></span>
				</div>
			</div>

			<div class="field">
				<button class="sc-button sc-button_primary" id="saveButton">{{$.locale.Tr "settings.save_application"}}</button>
			</div>
		</form>
	</div>

	<script>
		function validateInput(input) {
			input.value = input.value.replace(/[^0-9]/g, '');

			const saveButton = document.getElementById('saveButton');
			const value = parseInt(input.value, 10);

			if (isNaN(value) || value < 1 || value > 100) {
				document.querySelector('.error-message').textContent = "Введите число от 1 до 100";
				saveButton.disabled = true;
			} else {
				document.querySelector('.error-message').textContent = "";
				saveButton.disabled = false;
			}
		}

		const approvalCheckbox = document.getElementById('approvalCheckbox');
		const amountUsersInput = document.getElementById('amountUsersInput');
		const saveButton = document.getElementById('saveButton');

		function updateSaveButtonState() {
			const isCheckboxChecked = approvalCheckbox.checked;
			const isInputEmpty = amountUsersInput.value.trim() === '';

			if (!isCheckboxChecked && isInputEmpty) {
				saveButton.disabled = false;
			} else {
				const value = parseInt(amountUsersInput.value, 10);
				if (isNaN(value) || value < 1 || value > 100) {
					saveButton.disabled = true;
				} else {
					saveButton.disabled = false;
				}
			}
		}

		approvalCheckbox.addEventListener('change', function() {
			amountUsersInput.disabled = !this.checked;
			updateSaveButtonState();
		});

		amountUsersInput.addEventListener('input', function() {
			updateSaveButtonState();
		});

		amountUsersInput.disabled = !approvalCheckbox.checked;
		updateSaveButtonState();
	</script>
	{{end}}

		{{if and .Permission.IsOwner (or (not EnableOneWork) (EnableRepositoryDelete))}}
			<h4 class="ui top attached error header">
				{{.locale.Tr "repo.settings.danger_zone"}}
			</h4>
			<div class="table ui attached error danger segment">
				{{if .Repository.IsMirror}}
					<div class="item clearfix">
						<div class="ui right">
							<button class="sc-button sc-button_danger show-modal" data-modal="#convert-mirror-repo-modal">{{.locale.Tr "repo.settings.convert"}}</button>
						</div>
						<div>
							<p>{{.locale.Tr "repo.settings.convert_desc"}}</p>
						</div>
					</div>
					<div class="ui divider"></div>
				{{end}}
				{{if and .Repository.IsFork .Repository.Owner.CanCreateRepo}}
					<div class="item clearfix">
						<div class="ui right">
							<button class="sc-button sc-button_danger show-modal" data-modal="#convert-fork-repo-modal">{{.locale.Tr "repo.settings.convert_fork"}}</button>
						</div>
						<div>
							<p>{{.locale.Tr "repo.settings.convert_fork_desc"}}</p>
						</div>
					</div>
					<div class="ui divider"></div>
				{{end}}

				{{if not EnableRoleModel}}
					<div class="item clearfix">
						<div class="ui right">
							{{if .RepoTransfer}}
								<form class="ui form" action="{{.Link}}" method="post">
									{{.CsrfTokenHtml}}
									<input type="hidden" name="action" value="cancel_transfer">
									<button class="sc-button sc-button_danger">{{.locale.Tr "repo.settings.transfer_abort"}}</button>
								</form>
							{{else}}
								<button class="sc-button sc-button_danger show-modal" data-modal="#transfer-repo-modal">{{.locale.Tr "repo.settings.transfer"}}</button>
							{{end}}
						</div>
						<div>
							{{if .RepoTransfer}}
								<p>{{.locale.Tr "repo.settings.transfer_started" .RepoTransfer.Recipient.DisplayName}}</p>
							{{else}}
								<p>{{.locale.Tr "repo.settings.transfer_desc"}}</p>
							{{end}}
						</div>
					</div>
				{{end}}

				{{if and EnableRoleModel EnableRepositoryDelete}}
					{{if and .RepoOwnerIsOrganization (CheckPrivileges .TraceID .TraceEndpoint .SignedUser.ID .TenantID .Owner.ID "delete")}}
						<div class="ui divider"></div>
						<div class="item clearfix">
							<div class="ui right">
								<button class="sc-button sc-button_danger show-modal" data-modal="#delete-repo-modal">{{.locale.Tr "repo.settings.delete"}}</button>
							</div>
							<div>
								<p>{{.locale.Tr "repo.settings.delete_desc"}}</p>
							</div>
						</div>

						{{if and (not .Repository.IsMirror) (not EnableOneWork)}}
							<div class="ui divider"></div>
							<div class="item clearfix">
								<div class="ui right">
									<button class="sc-button sc-button_danger show-modal" data-modal="#archive-repo-modal">
										{{if .Repository.IsArchived}}
											{{.locale.Tr "repo.settings.unarchive.button"}}
										{{else}}
											{{.locale.Tr "repo.settings.archive.button"}}
										{{end}}
									</button>
								</div>
								<div>
									{{if .Repository.IsArchived}}
										<p>{{.locale.Tr "repo.settings.unarchive.text"}}</p>
									{{else}}
										<p>{{.locale.Tr "repo.settings.archive.text"}}</p>
									{{end}}
								</div>
							</div>
						{{end}}
					{{end}}
				{{else}}
					{{if EnableRepositoryDelete}}
						<div class="ui divider"></div>
						<div class="item clearfix">
							<div class="ui right">
								<button class="sc-button sc-button_danger  show-modal" data-modal="#delete-repo-modal">{{.locale.Tr "repo.settings.delete"}}</button>
							</div>
							<div>
								<p>{{.locale.Tr "repo.settings.delete_desc"}}</p>
							</div>
						</div>
					{{end}}

					{{if and (not .Repository.IsMirror) (not EnableOneWork) }}
						<div class="ui divider"></div>
						<div class="item clearfix">
							<div class="ui right">
								<button class="sc-button sc-button_danger show-modal" data-modal="#archive-repo-modal">
									{{if .Repository.IsArchived}}
										{{.locale.Tr "repo.settings.unarchive.button"}}
									{{else}}
										{{.locale.Tr "repo.settings.archive.button"}}
									{{end}}
								</button>
							</div>
						<div>
						{{if .Repository.IsArchived}}
							<p>{{.locale.Tr "repo.settings.unarchive.text"}}</p>
						{{else}}
							<p>{{.locale.Tr "repo.settings.archive.text"}}</p>
						{{end}}
					{{end}}
				{{end}}
			</div>
		{{end}}

{{template "repo/settings/layout_footer" .}}

{{if .Permission.IsOwner}}
	{{if .Repository.IsMirror}}
		<div class="ui small modal" id="convert-mirror-repo-modal">
			<div class="header">
				{{.locale.Tr "repo.settings.convert"}}
			</div>
			<div class="content">
				<div class="ui warning message">
					{{.locale.Tr "repo.settings.convert_notices_1"}}
				</div>
				<form class="ui form" action="{{.Link}}" method="post">
					{{.CsrfTokenHtml}}
					<input type="hidden" name="action" value="convert">
					<div class="field">
						<label>
							{{.locale.Tr "repo.settings.transfer_form_title"}}
							<span class="text red">{{.Repository.Name}}</span>
						</label>
					</div>
					<div class="required field">
						<label for="repo_name">{{.locale.Tr "repo.repo_name"}}</label>
						<input id="repo_name" name="repo_name" required>
					</div>

					<div class="text right actions">
						<button class="sc-button sc-button_base  cancel button">{{.locale.Tr "settings.cancel"}}</button>
						<button class="sc-button sc-button_danger">{{.locale.Tr "repo.settings.convert_confirm"}}</button>
					</div>
				</form>
			</div>
		</div>
	{{end}}
	{{if and .Repository.IsFork .Repository.Owner.CanCreateRepo}}
		<div class="ui small modal" id="convert-fork-repo-modal">
			<div class="header">
				{{.locale.Tr "repo.settings.convert_fork"}}
			</div>
			<div class="content">
				<div class="ui warning message">
					{{.locale.Tr "repo.settings.convert_fork_notices_1"}}
				</div>
				<form class="ui form" action="{{.Link}}" method="post">
					{{.CsrfTokenHtml}}
					<input type="hidden" name="action" value="convert_fork">
					<div class="field">
						<label>
							{{.locale.Tr "repo.settings.transfer_form_title"}}
							<span class="text red">{{.Repository.Name}}</span>
						</label>
					</div>
					<div class="required field">
						<label for="repo_name">{{.locale.Tr "repo.repo_name"}}</label>
						<input id="repo_name" name="repo_name" required>
					</div>

					<div class="text right actions">
						<button class="sc-button sc-button_base  cancel button">{{.locale.Tr "settings.cancel"}}</button>
						<button class="sc-button sc-button_danger">{{.locale.Tr "repo.settings.convert_fork_confirm"}}</button>
					</div>
				</form>
			</div>
		</div>
	{{end}}
	<div class="ui small modal" id="transfer-repo-modal">
		<div class="header">
			{{.locale.Tr "repo.settings.transfer"}}
		</div>
		<div class="content">
			<div class="ui warning message">
				{{.locale.Tr "repo.settings.transfer_notices_1"}} <br>
				{{.locale.Tr "repo.settings.transfer_notices_2"}} <br>
				{{.locale.Tr "repo.settings.transfer_notices_3"}}
			</div>
			<form class="ui form" action="{{.Link}}" method="post">
				{{.CsrfTokenHtml}}
				<input type="hidden" name="action" value="transfer">
				<div class="field">
					<label>
						{{.locale.Tr "repo.settings.transfer_form_title"}}
						<span class="text red">{{.Repository.Name}}</span>
					</label>
				</div>
				<div class="required field">
					<label for="repo_name">{{.locale.Tr "repo.repo_name"}}</label>
					<input id="repo_name" name="repo_name" required>
				</div>
				<div class="required field">
					<label for="new_owner_name">{{.locale.Tr "repo.settings.transfer_owner"}}</label>
					<input id="new_owner_name" name="new_owner_name" required>
				</div>

				<div class="text right actions">
					<button class="sc-button sc-button_base  cancel button">{{.locale.Tr "settings.cancel"}}</button>
					<button class="sc-button sc-button_danger">{{.locale.Tr "repo.settings.transfer_perform"}}</button>
				</div>
			</form>
		</div>
	</div>

	<div class="ui small modal" id="delete-repo-modal">
		<div class="header">
			{{.locale.Tr "repo.settings.delete"}}
		</div>
		<div class="content">
			<div class="ui warning message">
				{{.locale.Tr "repo.settings.delete_notices_1" | Safe}}<br>
				{{.locale.Tr "repo.settings.delete_notices_2" .Repository.FullName | Safe}}
				{{if .Repository.NumForks}}<br>
				{{.locale.Tr "repo.settings.delete_notices_fork_1"}}
				{{end}}
			</div>
			<form class="ui form" action="{{.Link}}" method="post">
				{{.CsrfTokenHtml}}
				<input type="hidden" name="action" value="delete">
				<div class="field">
					<label>
						{{.locale.Tr "repo.settings.transfer_form_title"}}
						<span class="text red">{{.Repository.Name}}</span>
					</label>
				</div>
				<div class="required field">
					<label for="repo_name">{{.locale.Tr "repo.repo_name"}}</label>
					<input id="repo_name" name="repo_name" required>
				</div>

				<div class="text right actions">
					<button class="sc-button sc-button_base  cancel button">{{.locale.Tr "settings.cancel"}}</button>
					<button class="sc-button sc-button_danger">{{.locale.Tr "repo.settings.confirm_delete"}}</button>
				</div>
			</form>
		</div>
	</div>

	{{if .Repository.UnitEnabled $.Context $.UnitTypeWiki}}
	<div class="ui small modal" id="delete-wiki-modal">
		<div class="header">
			{{.locale.Tr "repo.settings.wiki_delete"}}
		</div>
		<div class="content">
			<div class="ui warning message">
				{{.locale.Tr "repo.settings.delete_notices_1" | Safe}}<br>
				{{.locale.Tr "repo.settings.wiki_delete_notices_1" .Repository.Name | Safe}}
			</div>
			<form class="ui form" action="{{.Link}}" method="post">
				{{.CsrfTokenHtml}}
				<input type="hidden" name="action" value="delete-wiki">
				<div class="field">
					<label>
						{{.locale.Tr "repo.settings.transfer_form_title"}}
						<span class="text red">{{.Repository.Name}}</span>
					</label>
				</div>
				<div class="required field">
					<label for="repo_name">{{.locale.Tr "repo.repo_name"}}</label>
					<input id="repo_name" name="repo_name" required>
				</div>

				<div class="text right actions">
					<button class="sc-button sc-button_base  cancel buttonton_base  cancel button">{{.locale.Tr "settings.cancel"}}</button>
					<button class="sc-button sc-button_danger">{{.locale.Tr "repo.settings.confirm_wiki_delete"}}</button>
				</div>
			</form>
		</div>
	</div>
	{{end}}

	{{if not .Repository.IsMirror}}
		<div class="ui g-modal-confirm modal" id="archive-repo-modal">
			<div class="header">
				{{if .Repository.IsArchived}}
					{{.locale.Tr "repo.settings.unarchive.header"}}
				{{else}}
					{{.locale.Tr "repo.settings.archive.header"}}
				{{end}}
			</div>
			<div class="content">
				<p>
					{{if .Repository.IsArchived}}
						{{.locale.Tr "repo.settings.unarchive.text"}}
					{{else}}
						{{.locale.Tr "repo.settings.archive.text"}}
					{{end}}
				</p>
			</div>
			<form action="{{.Link}}" method="post">
				{{.CsrfTokenHtml}}
				<input type="hidden" name="action" value="{{if .Repository.IsArchived}}unarchive{{else}}archive{{end}}">
				<input type="hidden" name="repo_id" value="{{.Repository.ID}}">
				{{template "base/modal_actions_confirm" .}}
			</form>
		</div>
	{{end}}
{{end}}
