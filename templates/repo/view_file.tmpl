
<div class="{{TabSizeClass .Editorconfig .FileName}} non-diff-file-content">
	<script>
		window.config.pageData = {
				baseLink: {{.Link}},
				filename:{{.FileName}},
				reponame:{{.RepoName}},
				username:{{.Username}},
				repoId:{{.Repository.ID}},
				branch: {{.BranchName }}
			}
	</script>

	<div id="license">
	</div>
	{{- if .FileError}}
		<div class="ui error message">
			<div class="text left gt-whitespace-pre">{{.FileError}}</div>
		</div>
	{{end}}
	{{- if .FileWarning}}
		<div class="ui warning message">
			<div class="text left gt-whitespace-pre">{{.FileWarning}}</div>
		</div>
	{{end}}

	<div class="sc-box sc-box_attached file">
		<div class="sc-box__header file-header">
			{{if .ReadmeInList}}
				<div class="file-header__readme">
					{{svg "octicon-book" 16 "gt-mr-3"}}
					<span>{{.FileName}}</span>
				</div>
			{{else}}
				{{template "repo/file_info" .}}
			{{end}}
		</div>
		<div class="sc-box__body file-body">
			{{if or .HasSourceRenderedToggle (not .ReadmeInList) .EscapeStatus.Escaped}}
			<div class="file-actions">
				{{if .HasSourceRenderedToggle}}
					<div class="ui compact icon buttons two-toggle-buttons">
						<a href="{{$.Link}}?display=source" class="ui mini basic button {{if .IsDisplayingSource}}active{{end}}" data-tooltip-content="{{.locale.Tr "repo.file_view_source"}}">{{svg "octicon-code" 15}}</a>
						<a href="{{$.Link}}" class="ui mini basic button {{if .IsDisplayingRendered}}active{{end}}" data-tooltip-content="{{.locale.Tr "repo.file_view_rendered"}}">{{svg "octicon-file" 15}}</a>
					</div>
				{{end}}
				{{if not .ReadmeInList}}
					<div class="sc-button-group">
						<a class="sc-button-group__item" href="{{$.RawFileLink}}">{{.locale.Tr "repo.file_raw"}}</a>
						{{if not .IsViewCommit}}
							<a class="sc-button-group__item" href="{{.RepoLink}}/src/commit/{{PathEscape .CommitID}}/{{PathEscapeSegments .TreePath}}">{{.locale.Tr "repo.file_permalink"}}</a>
						{{end}}
						{{if .IsRepresentableAsText}}
							<a class="sc-button-group__item" href="{{.RepoLink}}/blame/{{.BranchNameSubURL}}/{{PathEscapeSegments .TreePath}}">{{.locale.Tr "repo.blame"}}</a>
						{{end}}
						<a class="sc-button-group__item" href="{{.RepoLink}}/commits/{{.BranchNameSubURL}}/{{PathEscapeSegments .TreePath}}">{{.locale.Tr "repo.file_history"}}</a>
						{{if .EscapeStatus.Escaped}}
							<button class="sc-button-group__item unescape-button gt-hidden">{{.locale.Tr "repo.unescape_control_characters"}}</button>
							<button class="sc-button-group__item escape-button">{{.locale.Tr "repo.escape_control_characters"}}</button>
						{{end}}
					</div>
					<div class="file-actions-group">
						<a download href="{{$.RawFileLink}}"><span class="sc-button sc-button_icon" data-tooltip-content="{{.locale.Tr "repo.download_file"}}">{{svg "octicon-download"}}</span></a>
						<a id="copy-content" class="sc-button sc-button_icon {{if not .CanCopyContent}} disabled{{end}}"{{if or .IsImageFile (and .HasSourceRenderedToggle (not .IsDisplayingSource))}} data-link="{{$.RawFileLink}}"{{end}} data-tooltip-content="{{if .CanCopyContent}}{{.locale.Tr "copy_content"}}{{else}}{{.locale.Tr "copy_type_unsupported"}}{{end}}">{{svg "octicon-copy" 14}}</a>
						{{if .EnableFeed}}
							<a class="sc-button sc-button_icon" href="{{$.FeedURL}}/rss/{{$.BranchNameSubURL}}/{{PathEscapeSegments .TreePath}}">{{svg "octicon-rss" 14}}</a>
						{{end}}
						{{if EnableRoleModel}}
								{{if and .RepoOwnerIsOrganization (not .Repository.IsMirror)}}
										{{if .Repository.IsPrivate}}
											{{if CheckPrivileges $.TraceID $.TraceEndpoint $.SignedUser.ID $.TenantID .Owner.ID "read_private"}}
												<a href="{{.RepoLink}}/_edit/{{PathEscapeSegments .BranchName}}/{{PathEscapeSegments .TreePath}}"><span class="sc-button sc-button_icon" data-tooltip-content="{{.EditFileTooltip}}">{{svg "octicon-pencil"}}</span></a>
												<a href="{{.RepoLink}}/_delete/{{PathEscapeSegments .BranchName}}/{{PathEscapeSegments .TreePath}}"><span class="sc-button sc-button_icon"  data-tooltip-content="{{.DeleteFileTooltip}}">{{svg "octicon-trash"}}</span></a>
											{{else if CheckPrivilegesByRoleAndCustom $.TraceID $.TraceEndpoint $.SignedUser.ID $.TenantID .Owner.ID .Repository.ID "changeBranch"}}
												<a href="{{.RepoLink}}/_edit/{{PathEscapeSegments .BranchName}}/{{PathEscapeSegments .TreePath}}"><span class="sc-button sc-button_icon" data-tooltip-content="{{.EditFileTooltip}}">{{svg "octicon-pencil"}}</span></a>
												<a href="{{.RepoLink}}/_delete/{{PathEscapeSegments .BranchName}}/{{PathEscapeSegments .TreePath}}"><span class="sc-button sc-button_icon"  data-tooltip-content="{{.DeleteFileTooltip}}">{{svg "octicon-trash"}}</span></a>
											{{end}}
										{{else if CheckPrivileges $.TraceID $.TraceEndpoint $.SignedUser.ID $.TenantID .Owner.ID "write"}}
											<a href="{{.RepoLink}}/_edit/{{PathEscapeSegments .BranchName}}/{{PathEscapeSegments .TreePath}}"><span class="sc-button sc-button_icon" data-tooltip-content="{{.EditFileTooltip}}">{{svg "octicon-pencil"}}</span></a>
											<a href="{{.RepoLink}}/_delete/{{PathEscapeSegments .BranchName}}/{{PathEscapeSegments .TreePath}}"><span class="sc-button sc-button_icon"  data-tooltip-content="{{.DeleteFileTooltip}}">{{svg "octicon-trash"}}</span></a>
										{{else if CheckPrivilegesByRoleAndCustom $.TraceID $.TraceEndpoint $.SignedUser.ID $.TenantID .Owner.ID .Repository.ID "changeBranch"}}
											<a href="{{.RepoLink}}/_edit/{{PathEscapeSegments .BranchName}}/{{PathEscapeSegments .TreePath}}"><span class="sc-button sc-button_icon" data-tooltip-content="{{.EditFileTooltip}}">{{svg "octicon-pencil"}}</span></a>
											<a href="{{.RepoLink}}/_delete/{{PathEscapeSegments .BranchName}}/{{PathEscapeSegments .TreePath}}"><span class="sc-button sc-button_icon"  data-tooltip-content="{{.DeleteFileTooltip}}">{{svg "octicon-trash"}}</span></a>
										{{end}}
								{{end}}
						{{else}}
							{{if .Repository.CanEnableEditor}}
								{{if .CanEditFile}}
									<a href="{{.RepoLink}}/_edit/{{PathEscapeSegments .BranchName}}/{{PathEscapeSegments .TreePath}}"><span class="sc-button sc-button_icon" data-tooltip-content="{{.EditFileTooltip}}">{{svg "octicon-pencil"}}</span></a>
								{{else}}
									<span class="sc-button sc-button_icon disabled" data-tooltip-content="{{.EditFileTooltip}}">{{svg "octicon-pencil"}}</span>
								{{end}}
								{{if .CanDeleteFile}}
									<a href="{{.RepoLink}}/_delete/{{PathEscapeSegments .BranchName}}/{{PathEscapeSegments .TreePath}}"><span class="sc-button sc-button_icon"  data-tooltip-content="{{.DeleteFileTooltip}}">{{svg "octicon-trash"}}</span></a>
								{{else}}
									<span class="sc-button sc-button_icon disabled" data-tooltip-content="{{.DeleteFileTooltip}}">{{svg "octicon-trash"}}</span>
								{{end}}
							{{end}}
						{{end}}
					</div>
				{{else if .EscapeStatus.Escaped}}
					<button class="sc-button sc-button_base sc-button_small button unescape-button gt-mr-1">{{.locale.Tr "repo.unescape_control_characters"}}</button>
					<button class="sc-button sc-button_base sc-button_small button escape-button gt-mr-1">{{.locale.Tr "repo.escape_control_characters"}}</button>
				{{end}}
			</div>
			{{end}}

			<div class="table ui attached unstackable file-content">
				{{if not (or .IsMarkup .IsRenderedHTML)}}
					{{template "repo/unicode_escape_prompt" dict "EscapeStatus" .EscapeStatus "root" $}}
				{{end}}
				<div class="file-view{{if .IsMarkup}} markup {{.MarkupType}}{{else if .IsPlainText}} plain-text{{else if .IsTextSource}} code-view{{end}}">
					{{if .IsMarkup}}
						{{if .FileContent}}{{.FileContent | Safe}}{{end}}
					{{else if .IsPlainText}}
						<pre>{{if .FileContent}}{{.FileContent | Safe}}{{end}}</pre>
					{{else if not .IsTextSource}}
						<div class="view-raw ui center">
							{{if .IsImageFile}}
								<img src="{{$.RawFileLink}}">
							{{else if .IsVideoFile}}
								<video controls src="{{$.RawFileLink}}">
									<strong>{{.locale.Tr "repo.video_not_supported_in_browser"}}</strong>
								</video>
							{{else if .IsAudioFile}}
								<audio controls src="{{$.RawFileLink}}">
									<strong>{{.locale.Tr "repo.audio_not_supported_in_browser"}}</strong>
								</audio>
							{{else if .IsPDFFile}}
								<iframe width="100%" height="600px" src="{{AssetUrlPrefix}}/vendor/plugins/pdfjs/web/viewer.html?file={{$.RawFileLink}}"></iframe>
							{{else}}
								<a href="{{$.RawFileLink}}" rel="nofollow" class="btn btn-gray btn-radius">{{.locale.Tr "repo.file_view_raw"}}</a>
							{{end}}
						</div>
					{{else if .FileSize}}
						{{if .IsFileTooLarge}}
						<table>
							<tbody>
								<tr>
									<td><strong>{{.locale.Tr "repo.file_too_large"}}</strong></td>
								</tr>
							</tbody>
						</table>
						{{else}}
						<table>
							<tbody>
								{{range $idx, $code := .FileContent}}
								{{$line := Eval $idx "+" 1}}
								<tr>
									<td id="L{{$line}}" class="lines-num"><span id="L{{$line}}" data-line-number="{{$line}}"></span></td>
									{{if $.EscapeStatus.Escaped}}
										<td class="lines-escape">{{if (index $.LineEscapeStatus $idx).Escaped}}<button class="toggle-escape-button button button-ghost" title="{{if (index $.LineEscapeStatus $idx).HasInvisible}}{{$.locale.Tr "repo.invisible_runes_line"}} {{end}}{{if (index $.LineEscapeStatus $idx).HasAmbiguous}}{{$.locale.Tr "repo.ambiguous_runes_line"}}{{end}}"></button>{{end}}</td>
									{{end}}
									<td rel="L{{$line}}" class="lines-code chroma"><code class="code-inner">{{$code | Safe}}</code></td>
								</tr>
								{{end}}
							</tbody>
						</table>
						<div class="code-line-menu ui vertical pointing menu tippy-target">
							{{if $.Permission.CanRead $.UnitTypeIssues}}
								<a class="item ref-in-new-issue" data-url-issue-new="{{.RepoLink}}/issues/new" data-url-param-body-link="{{.Repository.Link}}/src/commit/{{PathEscape .CommitID}}/{{PathEscapeSegments .TreePath}}" rel="nofollow noindex">{{.locale.Tr "repo.issues.context.reference_issue"}}</a>
							{{end}}
							<a class="item view_git_blame" href="{{.Repository.Link}}/blame/commit/{{PathEscape .CommitID}}/{{PathEscapeSegments .TreePath}}">{{.locale.Tr "repo.view_git_blame"}}</a>
							<a class="item copy-line-permalink" data-url="{{.Repository.Link}}/src/commit/{{PathEscape .CommitID}}/{{PathEscapeSegments .TreePath}}">{{.locale.Tr "repo.file_copy_permalink"}}</a>
						</div>
						{{end}}
					{{end}}
				</div>
			</div>
		</div>
	</div>
</div>
